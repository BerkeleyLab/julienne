

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A standalone, minimal unit-testing and string/command-line-handling utility.">
    <meta name="author" content="Berkeley Lab" >
    <link rel="icon" href="./favicon.png">

    <title> Julienne </title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="./css/fontawesome.min.css" rel="stylesheet">
    <link href="./css/brands.min.css" rel="stylesheet">
    <link href="./css/regular.min.css" rel="stylesheet">
    <link href="./css/solid.min.css" rel="stylesheet">
    <link href="./css/v4-font-face.min.css" rel="stylesheet">
    <link href="./css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="./css/local.css" rel="stylesheet">
    <link href="./css/pygments.css" rel="stylesheet">
    <script src="./js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="./index.html">Julienne </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="./lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="./search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <!-- Main component for a primary marketing message or call to action -->
    <div class="p-5 mb-4 bg-light border rounded-3" id="jumbotron">
      <p>A standalone, minimal unit-testing and string/command-line-handling utility.</p>
        <p> Find us on&hellip;</p>
      <p>
        <a class="btn btn-lg btn-primary" href="https://github.com/berkeleylab/inference-engine
https://github.com/sourceryinstitute/julienne" role="button">GitHub</a>
        
        
        
        
        <a class="btn btn-lg btn-danger" style="float:right" href="https://github.com/sourceryinstitute/julienne/releases" role="button">Download the Source</a>
      </p>
    </div>

      <div class="row" id='text'>
        <div class=col-md-8>
          <h1>Julienne</h1>
          <p align="center">
  <img width="250" height="250" src="https://github.com/user-attachments/assets/1a1c4f1a-f229-4d6d-bcaa-d5d9826ee639">
</p>

<h1 id="julienne-idiomatic-correctness-checking-for-fortran-2023">Julienne: Idiomatic Correctness Checking for Fortran 2023</h1>
<p>The Julienne framework offers a unified approach to unit testing and checking 
runtime assertions.  Julienne defines idioms for specifying correctness
conditions in a common way when writing tests that wrap the tested procedures
or assertions that conditionally execute inside procedures.  Julienne's idioms
center around expressions built up from defined operations: a uniquely flexible
Fortran capability that allows developers to define <em>new</em> operators in addition
to overloading the Fortran's intrinsic operators.</p>
<h2 id="assertions">Assertions</h2>
<p>Functional programming patterns centered around <code>pure</code> procedures enhance
code clarity, ease refactoring, and encourage optimization.  For example,
the constraints on <code>pure</code> procedures make it easier for a developer or a
compiler to safely reorder program statements.  Moreover, Fortran allows
invoking only <code>pure</code> procedures inside <code>do concurrent</code>, a construct that
compilers can automatically offload to a graphics processing unit (GPU).</p>
<p>Julienne lowers a widely stated barrier to writing <code>pure</code> procedures (including
<code>simple</code> procedures): the difficulty in printing values while debugging code.
The Julienne philosophy is that printing a value for debugging purposes implies
an expectation about the value.  Assert such expectations by writing Julienne
expressions inspired by natural language.  A program will proceed quietly past
a correct assertion.  An incorrect assertion produces either automated or custom
diagnostic messages during error termination.</p>
<p>To write a Julienne assertion, insert a function-like preprocessor macro
<code>call_julienne_assert</code> on a single line as in the following program:</p>
<div class="codehilite"><pre><span></span><code><span class="cp">#include &quot;julienne-assertion-macros.h&quot;</span>
<span class="k">program </span><span class="n">main</span>
<span class="w">  </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="n">julienne_m</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">call_julienne_assert_</span>
<span class="w">  </span><span class="k">implicit none</span>
<span class="k">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="n">tolerance</span><span class="o">=</span><span class="mf">3.</span>
<span class="w">  </span><span class="n">call_julienne_assert</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">.</span><span class="n">approximates</span><span class="p">.</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">.</span><span class="n">within</span><span class="p">.</span><span class="w"> </span><span class="n">tolerance</span><span class="p">)</span>
<span class="k">end program</span>
</code></pre></div>

<p>where inserting <code>-DASSERTIONS</code> in a compile command will expand the macro to</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="k">call </span><span class="n">call_julienne_assert_</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">.</span><span class="n">approximates</span><span class="p">.</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">.</span><span class="n">within</span><span class="p">.</span><span class="w"> </span><span class="n">tolerance</span><span class="p">)</span>
</code></pre></div>

<p>and where dots (<code>.</code>) delimit Julienne operators and the parenthetical expression
evaluates to a Julienne <code>test_diagnosis_t</code> object that has two components:</p>
<ol>
<li>A <code>logical</code> indicator of the assertion's truth and</li>
<li>An automatically constructed diagnostic message.</li>
</ol>
<p>Please see [Julienne operators] for a list of available operators.</p>
<h2 id="unit-tests">Unit tests</h2>
<p>Writing tests using Julienne involves constructing a test-description array,
in which each element is a <code>test_description_t</code> constructor function invocation
with two arguments: a <code>character</code> string describing what the test does and the
name of a function that performs the test.  An example follows:</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">test_description_t</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="n">test_descriptions</span><span class="p">(:)</span>
<span class="w">  </span><span class="n">test_descriptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="n">test_description_t</span><span class="p">(</span><span class="s2">&quot;checking something&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">check_something</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="p">,</span><span class="n">test_description_t</span><span class="p">(</span><span class="s2">&quot;checking something else&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">check_something_else</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">  </span><span class="p">]</span>
</code></pre></div>

<p>Execute the tests by calling the <code>test_description_t</code> type-bound <code>run</code> procedure
on the <code>test_descriptions</code> array.</p>
<p>Define each test function to produce a <code>test_diagnosis_t</code> object result
encapsulating the two components enumerated in the <a href="#assertions">Assertions</a> section.
Use one of Julienne's expression idioms to construct the function result
automatically:</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="k">function </span><span class="n">check_something</span><span class="p">()</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">test_diagnosis_t</span><span class="p">)</span><span class="w"> </span><span class="n">test_diagnosis</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span>
<span class="w">    </span><span class="n">test_diagnosis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">.</span><span class="n">equalsExpected</span><span class="p">.</span><span class="w"> </span><span class="n">j</span>
<span class="w">  </span><span class="k">end function</span>
</code></pre></div>

<p>where the <code>.equalsExpected.</code> operator is named to imply an asymmetry with
respect to the arguments <code>i</code> and <code>j</code>.  If the condition <code>i==j</code> evaluates to
<code>.false.</code>, Julienne constructs a diagnostic message reflecting the implied
asymmetry, i.e., indicating that <code>i</code> is the actual value, whereas <code>j</code> is the
expected value.</p>
<p>Please see the demonstration test suite in <a href="./demo/README.md">demo README.md</a>
for more detailed instructions on setting up a new test suite, including how
to customize the diagnostic output using the string-manipulation capabilities
associated with Julienne's <code>string_t</code> derived type.  The demonstration test
suite's main program also shows how to use Julienne's <code>command_line_t</code> type
to access arguments that users pass to program via a command line or shell
script.  Julienne also offers useful input/output format strings and
format-generating functions.</p>
<h2 id="an-origin-story">An Origin Story</h2>
<p>Julienne's name derives from the term for vegetables sliced into thin strings:
julienned vegetables.  The <a href="https://gitlab.com/everythingfunctional/veggies">Veggies</a> and <a href="https://gitlab.com/everythingfunctional/garden">Garden</a> unit-testing frameworks
inspired the structure of Julienne's tests and output.  Initially developed in
the <a href="https://github.com/sourceryinstitute/sourcery">Sourcery</a> repository as lightweight alternative with greater portability
across compilers, Julienne's chief innovation lies in the expressive idioms the
framework supports.</p>
<h2 id="getting-started">Getting Started</h2>
<p>Please see the demonstration test suite in <a href="./demo/README.md">demo README.md</a>.</p>
<h2 id="compiler-support">Compiler Support</h2>
<p>The table below shows the compilers that Julienne fully or partially supports.
When built with a fully supported compiler, all Julienne tests pass.  When built
with a partially supported compiler, the Julienne test suite skips some tests
due to compiler bugs.  The test output reports which tests are skipped and
thereby details any features Julienne does not supported with a given compiler.</p>
<table>
<thead>
<tr>
<th>Compiler</th>
<th>Version(s) Tested</th>
<th>Support</th>
</tr>
</thead>
<tbody>
<tr>
<td>LLVM <code>flang-new</code></td>
<td>19, 20</td>
<td>full</td>
</tr>
<tr>
<td>NAG <code>nagfor</code></td>
<td>7.2 Build 7227</td>
<td>full</td>
</tr>
<tr>
<td>GCC <code>gfortran</code></td>
<td>13.1.0, 14.2.0_1, 15.0.1</td>
<td>partial (see 1 below)</td>
</tr>
<tr>
<td>Intel <code>ifx</code></td>
<td>2025.4 Build 20241205</td>
<td>partial (see 2 below)</td>
</tr>
</tbody>
</table>
<p>Compiler bugs related to the following issues have been reported:</p>
<ol>
<li><code>gfortran</code> issues:</li>
<li>The <code>test_description_t</code> constructor's [<code>diagnosis_function</code>] actual
     argument must be a procedure pointer.</li>
<li>Each element of a [<code>vector_test_description_t</code>] array (a feature to be
     deprecated in a future release) must be defined in a separate statement.</li>
<li>The <code>string_t</code> type's <code>bracket</code> type-bound procedure causes a program crash.</li>
<li>The <code>string_t</code> type's <code>.all.</code> operator causes a program crash.</li>
<li><code>ifx</code> issue:</li>
<li>Two <code>string_t</code> tests fail as described in issue <a href="https://github.com/BerkeleyLab/julienne/issues/51">#51</a>.</li>
</ol>
<h2 id="building-and-testing">Building and Testing</h2>
<h4 id="llvm-flang-new-compiler">LLVM (<code>flang-new</code>) compiler</h4>
<h5 id="flang-new-version-20-or-later"><code>flang-new</code> version 20 or later</h5>
<div class="codehilite"><pre><span></span><code>fpm test --compiler flang-new
</code></pre></div>

<h5 id="flang-new-version-19"><code>flang-new</code> version 19</h5>
<p>Add the following command before the <code>fpm</code> command recommended above for
LLVM 20 or later:</p>
<div class="codehilite"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">FPM_FFLAGS</span><span class="o">=</span><span class="s2">&quot;-mmlir -allow-assumed-rank&quot;</span>
</code></pre></div>

<p>where this <code>FPM_FFLAGS</code> setting turns on the support for Fortran's assumed-rank
dummy arguments.</p>
<p>If you do not have access to LLVM 19 or 20, we recommend building the
llvm-project main branch from source.  A script that might help with
doing so is in the <a href="https://github.com/rouson/handy-dandy/blob/7caaa4dc3d6e5331914a3025f0cb1db5ac1a886f/src/fresh-llvm-build.sh">handy-dandy</a> repository.</p>
<h3 id="nag-nagfor-compiler">NAG (<code>nagfor</code>) compiler</h3>
<div class="codehilite"><pre><span></span><code>fpm test --compiler nagfor --flag -fpp
</code></pre></div>

<h4 id="gnu-gfortran-compiler">GNU (<code>gfortran</code>) compiler</h4>
<h5 id="gfortran-versions-14-or-higher"><code>gfortran</code> versions 14 or higher</h5>
<div class="codehilite"><pre><span></span><code>fpm test --compiler gfortran --profile release
</code></pre></div>

<h5 id="gfortran-version-13"><code>gfortran</code> version 13</h5>
<div class="codehilite"><pre><span></span><code>fpm test --compiler gfortran --profile release --flag &quot;-ffree-line-length-none&quot;
</code></pre></div>

<p>where the <code>-ffree-line-length-none</code> turns on support for lines exceeding the Fortran 2018 limit of 132 columns.
(Fortran 2023 expands the allowable line length to 5,000 characters.)</p>
<h4 id="intel-ifx-compiler">Intel (<code>ifx</code>) compiler</h4>
<div class="codehilite"><pre><span></span><code>fpm test --compiler ifx --flag &quot;-fpp -O3 -coarray&quot; --profile release
</code></pre></div>

<h2 id="documentation">Documentation</h2>
<p>See our online <a href="https:///berkeleylab.github.io/julienne/">documentation</a> or build the documentation locally by installing <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a> and executing <code>ford ford.md</code>.</p>
        </div>
          <div class="col-md-4">
            <div class="card card-body bg-light">
              <h2 class="card-title">Developer Info</h2>
              <h4 class="card-text">Berkeley Lab</h4>
              <p class="card-text"></p>
                <div class="text-center"><div class="btn-group" role="group">
                    
                    <a class="btn btn-lg btn-primary" href="https://github.com/sourceryinstitute"><i class="fa fa-github fa-lg"></i></a>
                    
                    
                    
                    
                    
                    
                </div></div>
            </div>
          </div>
      </div>
        <div class="row">
          <hr>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Source Files</h3>
              <ul><li><a href='sourcefile/check-for-command-line-argument.f90.html'>check-for-command-line-argument.f90</a></li><li><a href='sourcefile/create-markdown-table.f90.html'>create-markdown-table.f90</a></li><li><a href='sourcefile/get-command-line-flag-value.f90.html'>get-command-line-flag-value.f90</a></li><li><a href='sourcefile/julienne_bin_m.f90.html'>julienne_bin_m.f90</a></li><li><a href='sourcefile/julienne_bin_s.f90.html'>julienne_bin_s.F90</a></li><li><a href='sourcefile/julienne_command_line_m.f90.html'>julienne_command_line_m.f90</a></li><li><a href='sourcefile/julienne_command_line_s.f90.html'>julienne_command_line_s.f90</a></li><li><a href='sourcefile/julienne_file_m.f90.html'>julienne_file_m.f90</a></li><li><a href='sourcefile/julienne_file_s.f90.html'>julienne_file_s.F90</a></li><li><a href='sourcefile/julienne_formats_m.f90.html'>julienne_formats_m.F90</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/files.html"><em>All source files&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Modules</h3>
              <ul><li><a href='module/julienne_bin_m.html'>julienne_bin_m</a></li><li><a href='module/julienne_command_line_m.html'>julienne_command_line_m</a></li><li><a href='module/julienne_file_m.html'>julienne_file_m</a></li><li><a href='module/julienne_formats_m.html'>julienne_formats_m</a></li><li><a href='module/julienne_github_ci_m.html'>julienne_github_ci_m</a></li><li><a href='module/julienne_m.html'>julienne_m</a></li><li><a href='module/julienne_string_m.html'>julienne_string_m</a></li><li><a href='module/julienne_test_description_m.html'>julienne_test_description_m</a></li><li><a href='module/julienne_test_diagnosis_m.html'>julienne_test_diagnosis_m</a></li><li><a href='module/julienne_test_m.html'>julienne_test_m</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/modules.html"><em>All modules&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Procedures</h3>
              <ul><li><a href='interface/argument_present.html'>argument_present</a></li><li><a href='interface/array_of_strings.html'>array_of_strings</a></li><li><a href='interface/as_character.html'>as_character</a></li><li><a href='interface/assign_character_to_string_t.html'>assign_character_to_string_t</a></li><li><a href='interface/assign_string_t_to_character.html'>assign_string_t_to_character</a></li><li><a href='interface/base_name.html'>base_name</a></li><li><a href='interface/bin_t.html'>bin_t</a></li><li><a href='interface/bracket.html'>bracket</a></li><li><a href='interface/call_julienne_assert_.html'>call_julienne_assert_</a></li><li><a href='interface/character_cat_string_t.html'>character_cat_string_t</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/procedures.html"><em>All procedures&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Derived Types</h3>
              <ul><li><a href='type/bin_t.html'>bin_t</a></li><li><a href='type/command_line_t.html'>command_line_t</a></li><li><a href='type/double_precision_operands_t.html'>double_precision_operands_t</a></li><li><a href='type/file_t.html'>file_t</a></li><li><a href='type/operands_t.html'>operands_t</a></li><li><a href='type/operands_t~2.html'>operands_t</a></li><li><a href='type/string_t.html'>string_t</a></li><li><a href='type/test_description_t.html'>test_description_t</a></li><li><a href='type/test_diagnosis_t.html'>test_diagnosis_t</a></li><li><a href='type/test_result_t.html'>test_result_t</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/types.html"><em>All derived types&hellip;</em></a></li>
              </ul>
            </div>
          </div>
        </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Julienne
 was developed by Berkeley Lab<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-05-28 18:27 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>